import tkinter as tk
from tkinter import ttk, scrolledtext, messagebox
from tkcalendar import Calendar
import os
from datetime import datetime, date

LOG_DIR = "logs"
os.makedirs(LOG_DIR, exist_ok=True)

class SimpleLogApp:
    def __init__(self, root):
        self.root = root
        self.root.title("ğŸ“… æˆ‘çš„æ—¥å¿— - ç®€æ´ç‰ˆ")
        self.root.geometry("600x500")

        # æ—¥å†æ§ä»¶é»˜è®¤å­—ä½“å·²è¢« root.option_add å½±å“
        today = date.today()
        self.cal = Calendar(
            root,
            selectmode='day',
            year=today.year,
            month=today.month,
            day=today.day
        )
        self.cal.pack(pady=10, fill="x")
        self.cal.bind("<<CalendarSelected>>", self.on_date_selected)

        # æ–‡æœ¬ç¼–è¾‘æ¡†
        self.log_text = scrolledtext.ScrolledText(
            root, wrap=tk.WORD, width=70, height=20
        )
        self.log_text.pack(pady=10, padx=10, fill="both", expand=True)

        # âœ… è®¾ç½®æ–‡æœ¬æ¡†èƒŒæ™¯è‰²
        self.log_text.configure(bg="#f8f8f8")

        save_btn = ttk.Button(root, text="ğŸ’¾ ä¿å­˜æ—¥å¿—", command=self.save_log)
        save_btn.pack(pady=5)

        today_str = today.strftime("%Y-%m-%d")
        self.cal.selection_set(today)
        self.selected_date = today_str
        self.load_log_for_date(today_str)

    def on_date_selected(self, event):
        dt = self.cal.selection_get()
        date_str = dt.strftime("%Y-%m-%d")
        self.selected_date = date_str
        self.load_log_for_date(date_str)

    def load_log_for_date(self, date_str):
        self.log_text.delete(1.0, tk.END)
        log_filename = os.path.join(LOG_DIR, f"log_{date_str}.txt")
        if os.path.exists(log_filename):
            with open(log_filename, "r", encoding="utf-8") as f:
                self.log_text.insert(tk.END, f.read())
        else:
            self.log_text.insert(tk.END, f"ğŸ“ è¿˜æ²¡æœ‰ä¸º {date_str} å†™æ—¥å¿—å“¦ï¼Œå¼€å§‹å†™ç‚¹ä»€ä¹ˆå§ï½")
        self.root.title(f"ğŸ“… æˆ‘çš„æ—¥å¿— - {date_str}")

    def save_log(self):
        if not self.selected_date:
            messagebox.showwarning("æœªé€‰æ‹©æ—¥æœŸ", "è¯·å…ˆé€‰æ‹©æ—¥æœŸï¼")
            return
        log_content = self.log_text.get(1.0, tk.END + "-1c")
        log_filename = os.path.join(LOG_DIR, f"log_{self.selected_date}.txt")
        with open(log_filename, "w", encoding="utf-8") as f:
            f.write(log_content)
        messagebox.showinfo("ä¿å­˜æˆåŠŸ", f"âœ… æ—¥å¿—å·²ä¿å­˜è‡³ï¼š{self.selected_date}")

if __name__ == "__main__":
    root = tk.Tk()
    
    # âœ… å…¨å±€å­—ä½“è®¾ç½®ï¼ˆè¦æ”¾åœ¨æ§ä»¶åˆ›å»ºå‰ï¼‰
    root.option_add("*Font", "å¾®è½¯é›…é»‘ 12")
    
    app = SimpleLogApp(root)
    root.mainloop()

